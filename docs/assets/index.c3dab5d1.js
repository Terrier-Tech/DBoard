var rt=Object.defineProperty,ot=Object.defineProperties;var at=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var lt=Object.prototype.hasOwnProperty,ct=Object.prototype.propertyIsEnumerable;var j=(r,t,e)=>t in r?rt(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,p=(r,t)=>{for(var e in t||(t={}))lt.call(t,e)&&j(r,e,t[e]);if(V)for(var e of V(t))ct.call(t,e)&&j(r,e,t[e]);return r},C=(r,t)=>ot(r,at(t));import{r as i,a as ht}from"./vendor.b71a34ef.js";const pt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=e(o);fetch(o.href,n)}};pt();class ut{constructor(){this.fontSize=14,this.lineHeight=32,this.padding=12,this.iconSize=48,this.minEntitySize=8*this.gridSize,this.borderSize=2,this.entityRadius=4,this.fontFamily="Verdana, Geneva, sans-serif",this.colors={blue:"#2980b9",green:"#27ae60",purple:"#8e44ad",cyan:"#079992",gray:"#bdc3c7",orange:"#f39c12",red:"#c0392b",yellow:"#f1c40f"},this.primaryColor="#7e7367",this.fgColor="#362b21",this.oddBgColor="#f6f2f0",this.evenBgColor="#ffffff",this.hintFgColor="#d9d0c7",this.hintBgColor="#f2e9df",this.utilCanvas=document.createElement("canvas"),this.utilContext=this.utilCanvas.getContext("2d")}get gridSize(){return this.lineHeight/2}measureText(t,e="normal"){return this.utilContext.font=`${e} ${this.fontSize}px sans-serif`,this.utilContext.measureText(t)}snapNearest(t){return Math.round(t/this.gridSize)*this.gridSize}snapUp(t){return Math.ceil(t/this.gridSize)*this.gridSize}snapUpEven(t){return Math.ceil(t/(2*this.gridSize))*this.gridSize*2}color(t){return this.colors[t]}}const _=r=>i.exports.createElement("svg",p({width:"160px",height:"48px",viewBox:"0 0 160 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"logo-white"),i.exports.createElement("g",{id:"logo-white",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.exports.createElement("g",{id:"board",transform:"translate(12.000000, 8.000000)",fill:"#FFFFFF"},i.exports.createElement("path",{d:"M31,4 C31.5522847,4 32,4.44771525 32,5 L32,23 C32,23.5522847 31.5522847,24 31,24 L1,24 C0.44771525,24 6.76353751e-17,23.5522847 0,23 L0,5 C-6.76353751e-17,4.44771525 0.44771525,4 1,4 L31,4 Z M29,8 L3,8 C2.44771525,8 2,8.44771525 2,9 L2,9 L2,21 C2,21.5522847 2.44771525,22 3,22 L3,22 L29,22 C29.5522847,22 30,21.5522847 30,21 L30,21 L30,9 C30,8.44771525 29.5522847,8 29,8 L29,8 Z",id:"Rectangle-2"}),i.exports.createElement("path",{d:"M16,0 C16.5522847,-1.01453063e-16 17,0.44771525 17,1 L17,4 L17,4 L15,4 L15,1 C15,0.44771525 15.4477153,1.01453063e-16 16,0 Z",id:"Rectangle"}),i.exports.createElement("path",{d:"M15,24 L17,24 L17,31 C17,31.5522847 16.5522847,32 16,32 C15.4477153,32 15,31.5522847 15,31 L15,24 L15,24 Z",id:"Rectangle-Copy-2"}),i.exports.createElement("path",{d:"M14,24 L7.06066017,30.9393398 C6.81801948,31.1819805 6.81801948,31.5753788 7.06066017,31.8180195 C7.17718034,31.9345397 7.3352156,32 7.5,32 L8.58578644,32 C8.85100293,32 9.10535684,31.8946432 9.29289322,31.7071068 L15,26 L15,26 L15,24 L14,24 Z",id:"Path-2"}),i.exports.createElement("path",{d:"M24,24 L17.9877569,30.871135 C17.7402159,31.154039 17.7688833,31.5840497 18.0517873,31.8315907 C18.1758644,31.9401582 18.3351302,32 18.5,32 L19.5316251,32 C19.8284049,32 20.1098525,31.868177 20.2998463,31.6401844 L25,26 L25,26 L25,24 L24,24 Z",id:"Path-2-Copy",transform:"translate(21.000000, 28.000000) scale(-1, 1) translate(-21.000000, -28.000000) "})),i.exports.createElement("g",{id:"DBoard-text-Copy",transform:"translate(56.693000, 13.774000)",fill:"#FFFFFF",fillRule:"nonzero"},i.exports.createElement("path",{d:"M-7.10542736e-15,18.226 L-7.10542736e-15,1.274 L4.784,1.274 C6.084,1.274 7.254,1.43866667 8.294,1.768 C9.334,2.09733333 10.2266667,2.60433333 10.972,3.289 C11.7173333,3.97366667 12.2893333,4.84466667 12.688,5.902 C13.0866667,6.95933333 13.286,8.216 13.286,9.672 C13.286,11.128 13.0866667,12.3933333 12.688,13.468 C12.2893333,14.5426667 11.726,15.431 10.998,16.133 C10.27,16.835 9.399,17.3593333 8.385,17.706 C7.371,18.0526667 6.24,18.226 4.992,18.226 L-7.10542736e-15,18.226 Z M3.822,15.132 L4.55,15.132 C5.278,15.132 5.93666667,15.0366667 6.526,14.846 C7.11533333,14.6553333 7.618,14.3476667 8.034,13.923 C8.45,13.4983333 8.775,12.9393333 9.009,12.246 C9.243,11.5526667 9.36,10.6946667 9.36,9.672 C9.36,8.66666667 9.243,7.82166667 9.009,7.137 C8.775,6.45233333 8.45,5.90633333 8.034,5.499 C7.618,5.09166667 7.11533333,4.80133333 6.526,4.628 C5.93666667,4.45466667 5.278,4.368 4.55,4.368 L3.822,4.368 L3.822,15.132 Z",id:"Shape"}),i.exports.createElement("path",{d:"M16.51,18.226 L16.51,1.274 L22.308,1.274 C23.192,1.274 24.011,1.339 24.765,1.469 C25.519,1.599 26.1776667,1.82866667 26.741,2.158 C27.3043333,2.48733333 27.7463333,2.92066667 28.067,3.458 C28.3876667,3.99533333 28.548,4.67133333 28.548,5.486 C28.548,5.86733333 28.496,6.24866667 28.392,6.63 C28.288,7.01133333 28.1406667,7.36666667 27.95,7.696 C27.7593333,8.02533333 27.5296667,8.32 27.261,8.58 C26.9923333,8.84 26.6846667,9.03066667 26.338,9.152 L26.338,9.256 C26.7713333,9.36 27.17,9.52033333 27.534,9.737 C27.898,9.95366667 28.2186667,10.2266667 28.496,10.556 C28.7733333,10.8853333 28.99,11.271 29.146,11.713 C29.302,12.155 29.38,12.662 29.38,13.234 C29.38,14.1006667 29.211,14.846 28.873,15.47 C28.535,16.094 28.067,16.6096667 27.469,17.017 C26.871,17.4243333 26.1733333,17.7276667 25.376,17.927 C24.5786667,18.1263333 23.7206667,18.226 22.802,18.226 L16.51,18.226 Z M20.332,8.06 L22.126,8.06 C23.062,8.06 23.7423333,7.878 24.167,7.514 C24.5916667,7.15 24.804,6.66466667 24.804,6.058 C24.804,5.39933333 24.5873333,4.93133333 24.154,4.654 C23.7206667,4.37666667 23.0533333,4.238 22.152,4.238 L20.332,4.238 L20.332,8.06 Z M20.332,15.262 L22.49,15.262 C24.5873333,15.262 25.636,14.4993333 25.636,12.974 C25.636,12.2286667 25.376,11.6956667 24.856,11.375 C24.336,11.0543333 23.5473333,10.894 22.49,10.894 L20.332,10.894 L20.332,15.262 Z",id:"Shape"}),i.exports.createElement("path",{d:"M37.466,18.538 C36.6513333,18.538 35.8626667,18.3863333 35.1,18.083 C34.3373333,17.7796667 33.6656667,17.342 33.085,16.77 C32.5043333,16.198 32.0406667,15.4916667 31.694,14.651 C31.3473333,13.8103333 31.174,12.8526667 31.174,11.778 C31.174,10.7033333 31.3473333,9.74566667 31.694,8.905 C32.0406667,8.06433333 32.5043333,7.358 33.085,6.786 C33.6656667,6.214 34.3373333,5.77633333 35.1,5.473 C35.8626667,5.16966667 36.6513333,5.018 37.466,5.018 C38.2806667,5.018 39.065,5.16966667 39.819,5.473 C40.573,5.77633333 41.2403333,6.214 41.821,6.786 C42.4016667,7.358 42.8653333,8.06433333 43.212,8.905 C43.5586667,9.74566667 43.732,10.7033333 43.732,11.778 C43.732,12.8526667 43.5586667,13.8103333 43.212,14.651 C42.8653333,15.4916667 42.4016667,16.198 41.821,16.77 C41.2403333,17.342 40.573,17.7796667 39.819,18.083 C39.065,18.3863333 38.2806667,18.538 37.466,18.538 Z M37.466,15.444 C38.246,15.444 38.8353333,15.1146667 39.234,14.456 C39.6326667,13.7973333 39.832,12.9046667 39.832,11.778 C39.832,10.6513333 39.6326667,9.75866667 39.234,9.1 C38.8353333,8.44133333 38.246,8.112 37.466,8.112 C36.6686667,8.112 36.075,8.44133333 35.685,9.1 C35.295,9.75866667 35.1,10.6513333 35.1,11.778 C35.1,12.9046667 35.295,13.7973333 35.685,14.456 C36.075,15.1146667 36.6686667,15.444 37.466,15.444 Z",id:"Shape"}),i.exports.createElement("path",{d:"M49.608,18.538 C49.0186667,18.538 48.4856667,18.4383333 48.009,18.239 C47.5323333,18.0396667 47.1293333,17.7623333 46.8,17.407 C46.4706667,17.0516667 46.215,16.64 46.033,16.172 C45.851,15.704 45.76,15.1926667 45.76,14.638 C45.76,13.286 46.332,12.2286667 47.476,11.466 C48.62,10.7033333 50.466,10.192 53.014,9.932 C52.9793333,9.36 52.8103333,8.905 52.507,8.567 C52.2036667,8.229 51.6966667,8.06 50.986,8.06 C50.4313333,8.06 49.881,8.164 49.335,8.372 C48.789,8.58 48.204,8.866 47.58,9.23 L46.202,6.708 C47.034,6.20533333 47.905,5.798 48.815,5.486 C49.725,5.174 50.6913333,5.018 51.714,5.018 C53.378,5.018 54.6476667,5.49033333 55.523,6.435 C56.3983333,7.37966667 56.836,8.84866667 56.836,10.842 L56.836,18.226 L53.716,18.226 L53.456,16.9 L53.352,16.9 C52.7973333,17.3853333 52.2166667,17.7796667 51.61,18.083 C51.0033333,18.3863333 50.336,18.538 49.608,18.538 Z M50.908,15.574 C51.3413333,15.574 51.714,15.4786667 52.026,15.288 C52.338,15.0973333 52.6673333,14.8286667 53.014,14.482 L53.014,12.22 C51.662,12.4106667 50.726,12.688 50.206,13.052 C49.686,13.416 49.426,13.8493333 49.426,14.352 C49.426,14.768 49.5603333,15.0756667 49.829,15.275 C50.0976667,15.4743333 50.4573333,15.574 50.908,15.574 Z",id:"Shape"}),i.exports.createElement("path",{d:"M60.06,18.226 L60.06,5.33 L63.18,5.33 L63.44,7.592 L63.544,7.592 C64.012,6.708 64.5753333,6.058 65.234,5.642 C65.8926667,5.226 66.5513333,5.018 67.21,5.018 C67.574,5.018 67.873,5.03966667 68.107,5.083 C68.341,5.12633333 68.5533333,5.19133333 68.744,5.278 L68.12,8.58 C67.8773333,8.51066667 67.652,8.45866667 67.444,8.424 C67.236,8.38933333 66.9933333,8.372 66.716,8.372 C66.2306667,8.372 65.7236667,8.54533333 65.195,8.892 C64.6663333,9.23866667 64.2286667,9.854 63.882,10.738 L63.882,18.226 L60.06,18.226 Z",id:"Path"}),i.exports.createElement("path",{d:"M75.01,18.538 C74.2126667,18.538 73.489,18.382 72.839,18.07 C72.189,17.758 71.6343333,17.3116667 71.175,16.731 C70.7156667,16.1503333 70.3603333,15.444 70.109,14.612 C69.8576667,13.78 69.732,12.8353333 69.732,11.778 C69.732,10.7206667 69.8836667,9.776 70.187,8.944 C70.4903333,8.112 70.889,7.40566667 71.383,6.825 C71.877,6.24433333 72.449,5.798 73.099,5.486 C73.749,5.174 74.412,5.018 75.088,5.018 C75.816,5.018 76.414,5.13933333 76.882,5.382 C77.35,5.62466667 77.8093333,5.954 78.26,6.37 L78.104,4.394 L78.104,0 L81.926,0 L81.926,18.226 L78.806,18.226 L78.546,16.952 L78.442,16.952 C77.9913333,17.4026667 77.4626667,17.7796667 76.856,18.083 C76.2493333,18.3863333 75.634,18.538 75.01,18.538 Z M75.998,15.418 C76.414,15.418 76.791,15.3313333 77.129,15.158 C77.467,14.9846667 77.792,14.6813333 78.104,14.248 L78.104,8.97 C77.7573333,8.658 77.402,8.44133333 77.038,8.32 C76.674,8.19866667 76.3186667,8.138 75.972,8.138 C75.3653333,8.138 74.828,8.42833333 74.36,9.009 C73.892,9.58966667 73.658,10.4953333 73.658,11.726 C73.658,13.0086667 73.8616667,13.9446667 74.269,14.534 C74.6763333,15.1233333 75.2526667,15.418 75.998,15.418 Z",id:"Shape"})))),dt=r=>i.exports.createElement("svg",p({width:"48px",height:"48px",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"icon-blank-document"),i.exports.createElement("g",{id:"icon-blank-document",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.exports.createElement("g",{id:"stroke-copy",transform:"translate(12.000000, 8.000000)",fill:"#FFFFFF",fillRule:"nonzero"},i.exports.createElement("path",{d:"M16.2928932,0.292893219 L23.7071068,7.70710678 C23.8946432,7.89464316 24,8.14899707 24,8.41421356 L24,31 C24,31.5522847 23.5522847,32 23,32 L1,32 C0.44771525,32 5.11724585e-16,31.5522847 0,31 L0,1 C-6.76353751e-17,0.44771525 0.44771525,1.01453063e-16 1,0 L15.5857864,0 C15.8510029,3.5039942e-15 16.1053568,0.10535684 16.2928932,0.292893219 Z M14.7567864,2 L3,2 C2.44771525,2 2,2.44771525 2,3 L2,29 C2,29.5522847 2.44771525,30 3,30 L21,30 C21.5522847,30 22,29.5522847 22,29 L22,9.24321356 C22,8.97799707 21.8946432,8.72364316 21.7071068,8.53610678 L15.4638932,2.29289322 C15.2763568,2.10535684 15.0220029,2 14.7567864,2 Z",id:"Path-12"}),i.exports.createElement("path",{d:"M16,1 L16,7 C16,7.55228475 16.4477153,8 17,8 L23,8 L23,8 L23,10 L15,10 C14.4477153,10 14,9.55228475 14,9 L14,1 L14,1 L16,1 Z",id:"Path-13"})))),mt=r=>i.exports.createElement("svg",p({width:"48px",height:"48px",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"icon-close"),i.exports.createElement("g",{id:"icon-close",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.exports.createElement("rect",{id:"Rectangle",fill:"#FFFFFF",transform:"translate(24.500000, 24.000000) rotate(45.000000) translate(-24.500000, -24.000000) ",x:8,y:22,width:33,height:4,rx:2}),i.exports.createElement("rect",{id:"Rectangle-Copy",fill:"#FFFFFF",transform:"translate(24.000000, 24.000000) rotate(45.000000) translate(-24.000000, -24.000000) ",x:22,y:8,width:4,height:32,rx:2}))),xt=r=>i.exports.createElement("svg",p({width:"48px",height:"48px",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"icon-delete"),i.exports.createElement("g",{id:"icon-delete",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.exports.createElement("path",{d:"M10,15 L10,13 C10,12.4477153 10.4477153,12 11,12 L37,12 C37.5522847,12 38,12.4477153 38,13 L38,15 L38,15 L10,15 Z",id:"Path-3",fill:"#FFFFFF"}),i.exports.createElement("path",{d:"M36,15 L36,40 C36,40.5522847 35.5522847,41 35,41 L35,41 L13,41 C12.4477153,41 12,40.5522847 12,40 L12,40 L12,15 L36,15 Z M25,17 L23,17 C22.4477153,17 22,17.4477153 22,18 L22,38 C22,38.5522847 22.4477153,39 23,39 L25,39 C25.5522847,39 26,38.5522847 26,38 L26,18 C26,17.4477153 25.5522847,17 25,17 Z M33,17 L31,17 C30.4477153,17 30,17.4477153 30,18 L30,38 C30,38.5522847 30.4477153,39 31,39 L33,39 C33.5522847,39 34,38.5522847 34,38 L34,18 C34,17.4477153 33.5522847,17 33,17 Z M17,17 L15,17 C14.4477153,17 14,17.4477153 14,18 L14,38 C14,38.5522847 14.4477153,39 15,39 L17,39 C17.5522847,39 18,38.5522847 18,38 L18,18 C18,17.4477153 17.5522847,17 17,17 Z",id:"Path-6",fill:"#FFFFFF"}),i.exports.createElement("path",{d:"M26,9 C27.6568542,9 29,10.3431458 29,12 C29,13.6568542 27.6568542,15 26,15 L22,15 C20.3431458,15 19,13.6568542 19,12 C19,10.3431458 20.3431458,9 22,9 L26,9 Z M26,11 L22,11 C21.4477153,11 21,11.4477153 21,12 L21,12 L21,13 C21,13.5522847 21.4477153,14 22,14 L22,14 L26,14 C26.5522847,14 27,13.5522847 27,13 L27,13 L27,12 C27,11.4477153 26.5522847,11 26,11 L26,11 Z",id:"Rectangle-2",fill:"#FFFFFF"}))),yt=r=>i.exports.createElement("svg",p({width:"48px",height:"48px",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"icon-download"),i.exports.createElement("g",{id:"icon-download",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.exports.createElement("path",{d:"M23.375305,29.500244 L16.226086,23.7808688 C15.7948241,23.4358593 15.7249027,22.8065669 16.0699122,22.375305 C16.2596844,22.1380897 16.5469973,22 16.8507811,22 L20,22 C20.5522847,22 21,21.5522847 21,21 L21,13 C21,12.4477153 21.4477153,12 22,12 L26,12 C26.5522847,12 27,12.4477153 27,13 L27,21 C27,21.5522847 27.4477153,22 28,22 L31.1492189,22 C31.7015037,22 32.1492189,22.4477153 32.1492189,23 C32.1492189,23.3037837 32.0111292,23.5910966 31.773914,23.7808688 L24.624695,29.500244 C24.2594764,29.7924189 23.7405236,29.7924189 23.375305,29.500244 Z",id:"Path-10",fill:"#FFFFFF"}),i.exports.createElement("path",{d:"M10,29 L10,35 C10,35.5522847 10.4477153,36 11,36 L37,36 C37.5522847,36 38,35.5522847 38,35 L38,29 C38,28.4477153 37.5522847,28 37,28 L35,28 C34.4477153,28 34,28.4477153 34,29 L34,31.2077207 C34,31.7600054 33.5522847,32.2077207 33,32.2077207 L15,32.2077207 C14.4477153,32.2077207 14,31.7600054 14,31.2077207 L14,29 C14,28.4477153 13.5522847,28 13,28 L11,28 C10.4477153,28 10,28.4477153 10,29 Z",id:"Path-9",fill:"#FFFFFF"}))),ft=r=>i.exports.createElement("svg",p({width:"48px",height:"48px",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"icon-github"),i.exports.createElement("g",{id:"icon-github",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.exports.createElement("path",{d:"M24,8 C32.836556,8 40,15.163444 40,24 C40,31.2946359 35.1183904,37.4491109 28.4437619,39.374834 C28.1343281,39.141899 27.9342384,38.8247689 27.9342384,38.4349788 L27.9342384,32.3428882 L27.9342384,32.3428882 L27.5025506,31.165503 C30.9142123,30.3979495 33.2136782,28.8632404 34.4009483,26.5613755 C36.1818534,23.1085783 34.6312024,18.8807796 33.190018,18.1280103 C33.7573762,16.0771787 33.6214349,14.3678419 32.7821942,13 C30.8976086,13 29.2816233,13.683921 27.9342384,15.0517629 C25.0076038,14.0098453 23.0155743,14.0098453 19.8499292,15.0517629 C18.5697955,13.683921 16.9826744,13 15.0885658,13 C14.3756295,14.3678419 14.2683267,16.0771787 14.7666574,18.1280103 C13.3439356,19.5837799 12.2116421,23.4581301 13.5842147,26.6985617 C14.4992631,28.8588494 16.8403346,30.3478298 20.6074292,31.165503 L20.2664011,33.4200611 C19.0679546,33.6591944 17.9730244,33.5691471 16.9816106,33.1499192 C15.4944898,32.5210773 14.8133808,30.7120647 13.792427,30.4154397 C13.1117911,30.2176898 12.5143155,30.2176898 12,30.4154397 C12.8997769,31.3378462 13.4972525,31.980329 13.792427,32.3428882 C14.2351888,32.8867271 14.7257577,34.8172735 16.4884849,35.5769272 C17.6636364,36.083363 18.9229418,36.2243873 20.2664011,36 L20.2664011,38.4349788 C20.196369,38.8665434 20.0397455,39.2023402 19.7965307,39.4423691 C12.9985755,37.5955407 8,31.3815103 8,24 C8,15.163444 15.163444,8 24,8 Z",id:"Oval-2",fill:"#FFFFFF"}))),gt=r=>i.exports.createElement("svg",p({width:"48px",height:"48px",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"icon-open"),i.exports.createElement("g",{id:"icon-open",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd",strokeLinejoin:"round"},i.exports.createElement("polyline",{id:"Path-11",stroke:"#FFFFFF",strokeWidth:2,points:"33 18 33 15 19 15 17 13 11 13 9 15 9 35 33 35 40 18 17 18 9 35"}))),wt=r=>i.exports.createElement("svg",p({width:"48px",height:"48px",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"icon-plus-entity"),i.exports.createElement("g",{id:"icon-plus-entity",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.exports.createElement("path",{d:"M39,8 C39.5522847,8 40,8.44771525 40,9 L40,37 C40,37.5522847 39.5522847,38 39,38 L9,38 C8.44771525,38 8,37.5522847 8,37 L8,9 C8,8.44771525 8.44771525,8 9,8 L39,8 Z M37,16 L11,16 C10.4477153,16 10,16.4477153 10,17 L10,17 L10,35 C10,35.5522847 10.4477153,36 11,36 L11,36 L37,36 C37.5522847,36 38,35.5522847 38,35 L38,35 L38,17 C38,16.4477153 37.5522847,16 37,16 L37,16 Z",id:"Rectangle-2",fill:"#FFFFFF"}),i.exports.createElement("g",{id:"plus",transform:"translate(18.000000, 20.000000)",fill:"#FFFFFF"},i.exports.createElement("rect",{id:"Rectangle",x:5,y:0,width:2,height:12,rx:1}),i.exports.createElement("rect",{id:"Rectangle-Copy-2",x:0,y:5,width:12,height:2,rx:1})))),Ct=r=>i.exports.createElement("svg",p({width:"48px",height:"32px",viewBox:"0 0 48 32",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"icon-plus-attribute"),i.exports.createElement("g",{id:"icon-plus-attribute",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.exports.createElement("g",{id:"plus",transform:"translate(2.000000, 10.000000)",fill:"#FFFFFF"},i.exports.createElement("rect",{id:"Rectangle",x:5,y:0,width:2,height:12,rx:1}),i.exports.createElement("rect",{id:"Rectangle-Copy-2",x:0,y:5,width:12,height:2,rx:1})),i.exports.createElement("rect",{id:"Rectangle",fill:"#FFFFFF",x:16,y:8,width:24,height:2,rx:1}),i.exports.createElement("rect",{id:"Rectangle-Copy",fill:"#FFFFFF",x:20,y:15,width:24,height:2,rx:1}),i.exports.createElement("rect",{id:"Rectangle-Copy-3",fill:"#FFFFFF",x:16,y:22,width:24,height:2,rx:1}))),Et=r=>i.exports.createElement("svg",p({width:"48px",height:"32px",viewBox:"0 0 48 32",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"icon-plus-association"),i.exports.createElement("g",{id:"icon-plus-association",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.exports.createElement("rect",{id:"Rectangle-Copy",fill:"#FFFFFF",x:18,y:15,width:26,height:2,rx:1}),i.exports.createElement("path",{d:"M33,15 L42.9454237,5.05457633 C43.1866726,4.8133274 43.5778144,4.8133274 43.8190633,5.05457633 C43.9349151,5.17042814 44,5.32755693 44,5.49139614 L44,6.56920791 C44,6.83405214 43.8949379,7.08808038 43.707866,7.27555462 L36,15 L36,15 L33,15 Z",id:"Path-7",fill:"#FFFFFF"}),i.exports.createElement("path",{d:"M33,28 L42.9606506,18.0393494 C43.1984161,17.8015839 43.5839103,17.8015839 43.8216758,18.0393494 C43.9358549,18.1535285 44,18.3083885 44,18.469862 L44,19.5290943 C44,19.7921888 43.8963178,20.0446844 43.711425,20.2318563 L36.0378746,28 L36.0378746,28 L33,28 Z",id:"Path-7-Copy",fill:"#FFFFFF",transform:"translate(38.500000, 22.500000) scale(1, -1) translate(-38.500000, -22.500000) "}),i.exports.createElement("g",{id:"plus",transform:"translate(2.000000, 10.000000)",fill:"#FFFFFF"},i.exports.createElement("rect",{id:"Rectangle",x:5,y:0,width:2,height:12,rx:1}),i.exports.createElement("rect",{id:"Rectangle-Copy-2",x:0,y:5,width:12,height:2,rx:1})))),bt=r=>i.exports.createElement("svg",p({width:"48px",height:"48px",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"icon-undo"),i.exports.createElement("g",{id:"icon-undo",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.exports.createElement("polygon",{id:"Path-5",fill:"#FFFFFF",points:"13 21 13 13 21 21"}),i.exports.createElement("path",{d:"M24,12 C30.627417,12 36,17.372583 36,24 C36,30.627417 30.627417,36 24,36 C22.8954305,36 22,35.1045695 22,34 C22,32.8954305 22.8954305,32 24,32 C28.418278,32 32,28.418278 32,24 C32,19.581722 28.418278,16 24,16 C19.581722,16 16,19.581722 16,24 C16,25.1045695 15.1045695,26 14,26 C12.8954305,26 12,25.1045695 12,24 C12,17.372583 17.372583,12 24,12 Z",id:"Oval",fill:"#FFFFFF",fillRule:"nonzero",transform:"translate(24.000000, 24.000000) rotate(45.000000) translate(-24.000000, -24.000000) "}))),vt=r=>i.exports.createElement("svg",p({width:"48px",height:"48px",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"icon-upload"),i.exports.createElement("g",{id:"icon-upload",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.exports.createElement("path",{d:"M23.375305,29.500244 L16.226086,23.7808688 C15.7948241,23.4358593 15.7249027,22.8065669 16.0699122,22.375305 C16.2596844,22.1380897 16.5469973,22 16.8507811,22 L20,22 C20.5522847,22 21,21.5522847 21,21 L21,13 C21,12.4477153 21.4477153,12 22,12 L26,12 C26.5522847,12 27,12.4477153 27,13 L27,21 C27,21.5522847 27.4477153,22 28,22 L31.1492189,22 C31.7015037,22 32.1492189,22.4477153 32.1492189,23 C32.1492189,23.3037837 32.0111292,23.5910966 31.773914,23.7808688 L24.624695,29.500244 C24.2594764,29.7924189 23.7405236,29.7924189 23.375305,29.500244 Z",id:"Path-10",fill:"#FFFFFF",transform:"translate(24.000000, 21.000000) scale(1, -1) translate(-24.000000, -21.000000) "}),i.exports.createElement("path",{d:"M10,29 L10,35 C10,35.5522847 10.4477153,36 11,36 L37,36 C37.5522847,36 38,35.5522847 38,35 L38,29 C38,28.4477153 37.5522847,28 37,28 L35,28 C34.4477153,28 34,28.4477153 34,29 L34,31.2077207 C34,31.7600054 33.5522847,32.2077207 33,32.2077207 L15,32.2077207 C14.4477153,32.2077207 14,31.7600054 14,31.2077207 L14,29 C14,28.4477153 13.5522847,28 13,28 L11,28 C10.4477153,28 10,28.4477153 10,29 Z",id:"Path-9",fill:"#FFFFFF"}))),Ft=r=>i.exports.createElement("svg",p({width:"48px",height:"48px",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"icon-redo"),i.exports.createElement("g",{id:"icon-redo",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.exports.createElement("polygon",{id:"Path-5",fill:"#FFFFFF",transform:"translate(31.000000, 17.000000) scale(-1, 1) translate(-31.000000, -17.000000) ",points:"27 21 27 13 35 21"}),i.exports.createElement("path",{d:"M24,12 C30.627417,12 36,17.372583 36,24 C36,30.627417 30.627417,36 24,36 C22.8954305,36 22,35.1045695 22,34 C22,32.8954305 22.8954305,32 24,32 C28.418278,32 32,28.418278 32,24 C32,19.581722 28.418278,16 24,16 C19.581722,16 16,19.581722 16,24 C16,25.1045695 15.1045695,26 14,26 C12.8954305,26 12,25.1045695 12,24 C12,17.372583 17.372583,12 24,12 Z",id:"Oval",fill:"#FFFFFF",fillRule:"nonzero",transform:"translate(24.000000, 24.000000) scale(-1, 1) rotate(45.000000) translate(-24.000000, -24.000000) "}))),Lt=r=>i.exports.createElement("svg",p({width:"48px",height:"48px",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"icon-save"),i.exports.createElement("g",{id:"icon-save",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.exports.createElement("polygon",{id:"Path-15",stroke:"#FFFFFF",strokeWidth:2,strokeLinejoin:"round",points:"13 13 13 35 35 35 35 14.6514216 33.3243239 13"}),i.exports.createElement("rect",{id:"Rectangle",stroke:"#FFFFFF",strokeWidth:2,strokeLinejoin:"round",x:17,y:25,width:14,height:10}),i.exports.createElement("path",{d:"M29,13 C29.5522847,13 30,13.4477153 30,14 L30,19 C30,19.5522847 29.5522847,20 29,20 L19,20 C18.4477153,20 18,19.5522847 18,19 L18,14 C18,13.4477153 18.4477153,13 19,13 L29,13 Z M28,14 L27,14 C26.4477153,14 26,14.4477153 26,15 L26,15 L26,18 C26,18.5522847 26.4477153,19 27,19 L27,19 L28,19 C28.5522847,19 29,18.5522847 29,18 L29,18 L29,15 C29,14.4477153 28.5522847,14 28,14 L28,14 Z",id:"Rectangle-Copy-3",fill:"#FFFFFF"}))),St=r=>i.exports.createElement("svg",p({width:"48px",height:"48px",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"icon-swap-vertical"),i.exports.createElement("g",{id:"icon-swap-vertical",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.exports.createElement("path",{d:"M20,9.47353678 L20,37 C20,37.5522847 19.5522847,38 19,38 L17,38 C16.4477153,38 16,37.5522847 16,37 L16,23 C16,22.4477153 15.5522847,22 15,22 L13.575782,22 C13.0234973,22 12.575782,21.5522847 12.575782,21 C12.575782,20.852792 12.6082826,20.7073995 12.6709633,20.574203 L18.0951813,9.04773974 C18.3303425,8.54802217 18.9260795,8.33355687 19.425797,8.56871808 C19.7762895,8.73365569 20,9.08617473 20,9.47353678 Z",id:"Path-8",fill:"#FFFFFF"}),i.exports.createElement("path",{d:"M36,14.4735368 L36,42 C36,42.5522847 35.5522847,43 35,43 L33,43 C32.4477153,43 32,42.5522847 32,42 L32,28 C32,27.4477153 31.5522847,27 31,27 L29.575782,27 C29.0234973,27 28.575782,26.5522847 28.575782,26 C28.575782,25.852792 28.6082826,25.7073995 28.6709633,25.574203 L34.0951813,14.0477397 C34.3303425,13.5480222 34.9260795,13.3335569 35.425797,13.5687181 C35.7762895,13.7336557 36,14.0861747 36,14.4735368 Z",id:"Path-8-Copy",fill:"#FFFFFF",transform:"translate(32.000000, 26.500000) rotate(180.000000) translate(-32.000000, -26.500000) "}))),kt=r=>i.exports.createElement("svg",p({width:"48px",height:"48px",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r),i.exports.createElement("title",null,"icon-terrier"),i.exports.createElement("g",{id:"icon-terrier",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},i.exports.createElement("path",{d:"M33.7602041,17.4224896 C33.3928571,18.7248636 33.0714286,19.679938 32.7959184,20.2877125 C32.6581633,21.8505614 32.5204082,23.93436 32.244898,25.4972088 C32.0612245,26.5391081 31.6938776,27.7546573 31.1428571,29.1438563 C31.2688026,33.0172946 31.3606393,35.1879181 31.4183673,35.6557267 C31.5049594,36.3574395 32.1071429,36.6976259 32.1071429,37.2185756 C32.1071429,37.7395252 31.8316327,38 30.4540816,38 C29.0765306,38 28.1122449,37.4790504 27.6989796,35.9162015 C27.4234694,34.8743022 27.2397959,33.8324029 27.1479592,32.7905037 C26.7806122,30.7935301 26.4591837,29.577981 26.1836735,29.1438563 C25.7704082,28.4926692 22.3265306,27.45077 19.9846939,27.45077 C17.6428571,27.45077 18.1938776,28.3624318 16.2653061,30.1857555 C14.3367347,32.0090792 13.2346939,32.6602663 12.5459184,33.7021655 C12.2216555,34.1926727 11.7193878,34.48359 11.7193878,35.3952518 C11.7193878,36.3069137 12.2704082,36.9428795 12.2704082,37.2185756 C12.2704082,37.5658753 11.7653061,37.8263501 10.755102,38 C9.56122449,38 8.82653061,37.8697626 8.55102041,37.6092878 C8.1377551,37.2185756 8,36.5673885 8,35.6557267 C8,35.0479521 8.22959184,33.8758154 8.68877551,32.1393166 C9.69897959,30.8369426 10.3877551,29.8818682 10.755102,29.2740937 C11.3061224,28.3624318 11.994898,24.8460218 12.2704082,23.4134103 C12.4540816,22.458336 12.9591837,21.6334991 13.7857143,20.9388996 C12.7755102,19.6365255 12.0867347,18.5946262 11.7193878,17.8132018 C11.1683673,16.6410651 10.8928571,14.687504 11.4438776,14.5572666 C11.994898,14.4270292 12.5459184,16.5108277 13.372449,17.552727 C13.9234694,18.2473265 14.6122449,18.8985135 15.4387755,19.5062881 C17.1836735,19.5062881 18.4693878,19.5062881 19.2959184,19.5062881 C20.5357143,19.5062881 22.1887755,19.6365255 23.5663265,19.2458133 C24.9438776,18.8551011 26.4591837,18.203914 27.9744898,16.3805903 C29.4897959,14.5572666 31.005102,11.9525184 32.3826531,11.4315688 C33.7602041,10.9106192 35.4132653,10.9106192 35.5510204,11.171094 C35.6887755,11.4315688 35.4132653,12.0827558 35.8265306,12.3432307 C36.2397959,12.6037055 37.0663265,13.1246551 37.0663265,13.3851299 C37.0663265,13.6456047 37.0663265,14.036317 38.1683673,14.8177414 C39.2704082,15.5991659 39.9591837,16.2503529 39.9591837,17.1620147 C39.9591837,18.0736766 38.5816327,20.4029146 37.4795918,20.6633894 C36.377551,20.9238642 35.5510204,19.2653061 35.1377551,18.3341514 C34.6785714,18.0736766 34.2193878,17.7697893 33.7602041,17.4224896 Z",id:"Path-2",fill:"#FFFFFF"}))),m={BlankDocument:dt,Close:mt,Delete:xt,Download:yt,Github:ft,Open:gt,PlusEntity:wt,PlusAttribute:Ct,PlusAssociation:Et,Undo:bt,Upload:vt,Redo:Ft,Save:Lt,SwapVertical:St,Terrier:kt};class At extends i.exports.Component{constructor(t){super(t);this.state={fileName:this.props.source.fileName}}componentDidMount(){this.setState({fileName:this.props.source.fileName})}render(){const t=this.props.ui.history;return i.exports.createElement("div",{id:"topbar"},i.exports.createElement("a",{className:"logo",onClick:()=>this.props.onOpen()},i.exports.createElement(_,null)),i.exports.createElement("div",{className:"spacer"}),i.exports.createElement("a",{className:"action",title:"Open",onClick:()=>this.props.onOpen()},i.exports.createElement(m.Open,null)),i.exports.createElement("div",{className:"text-field"},i.exports.createElement("input",{type:"text",className:"file-name",onChange:this.onFileNameChanged.bind(this),value:this.state.fileName})),i.exports.createElement("a",{className:"action",title:"Save",onClick:this.save.bind(this)},i.exports.createElement(m.Save,null)),i.exports.createElement("a",{className:"action",title:"Download",onClick:this.download.bind(this)},i.exports.createElement(m.Download,null)),i.exports.createElement("div",{className:"spacer"}),i.exports.createElement("a",{className:`action ${t.canUndo()?"":"inactive"}`,onClick:()=>t.undo()},i.exports.createElement(m.Undo,null)),i.exports.createElement("a",{className:`action ${t.canRedo()?"":"inactive"}`,onClick:()=>t.redo()},i.exports.createElement(m.Redo,null)),i.exports.createElement("a",{className:"action",onMouseDown:this.startNewEntity.bind(this),onClick:()=>alert("Drag this icon onto the canvas to add a new entity")},i.exports.createElement(m.PlusEntity,null)))}startNewEntity(t){this.props.ui.interactor.beginNewEntity()}save(){this.props.source.save(this.props.schema)}download(){this.props.source.export(this.props.schema)}onFileNameChanged(t){this.props.source.fileName=t.currentTarget.value,this.setState({fileName:this.props.source.fileName})}}class b{constructor(t,e){this.x=t,this.y=e}}function Q(r,t){return{x:r.x+t.x,y:r.y+t.y}}function L(r,t){return{x:r.x-t.x,y:r.y-t.y}}function S(r){return{x:Math.round(r.x),y:Math.round(r.y)}}function Rt(r){if(!r.length)return{x:0,y:0};let t=r[0];for(let e of r)t={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y)};return t}function Mt(r){if(!r.length)return{x:0,y:0};let t=r[0];for(let e of r)t={x:Math.max(e.x,t.x),y:Math.max(e.y,t.y)};return t}function P(r,t){return r.x*t.y-r.y*t.x}function k(r,t){const e=r[0],s=t[0],o=L(r[1],r[0]),n=L(t[1],t[0]),a=P(o,n);if(a==0)return null;const l=P(L(s,e),n)/a,c=P(L(s,e),o)/a;return c>=0&&c<=1&&l>=0&&l<=1?{x:s.x+c*n.x,y:s.y+c*n.y}:null}class z{constructor(t,e,s,o){this.x=t,this.y=e,this.width=s,this.height=o}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}isWithin(t){return this.x>=t.x&&this.y>=t.y&&this.right<=t.right&&this.bottom<=t.bottom}}function W(r){return{x:(r.left+r.right)/2,y:(r.top+r.bottom)/2}}function D(r){if(!r.length)throw"Must provide at least one point for the rectangle!";let t=null,e=null,s=null,o=null;for(let n of r)t=t?Math.min(t,n.x):n.x,e=e?Math.min(e,n.y):n.y,s=s?Math.max(s,n.x):n.x,o=o?Math.max(o,n.y):n.y;return new z(t,e,s-t,o-e)}function Nt(r,t){return t.x>=r.left&&t.x<=r.right&&t.y>=r.top&&t.y<=r.bottom}function Pt(r){return{ne:{x:r.right,y:r.top},nw:{x:r.left,y:r.top},se:{x:r.right,y:r.bottom},sw:{x:r.left,y:r.bottom}}}class $t extends i.exports.Component{constructor(t){super(t)}render(){const t=this.props.config,e=this.props.attribute,s=this.props.width,o=e.state,n=this.props.x,a=this.props.y;this.props.attribute.position=new b(n,a);const l=a+t.lineHeight/2+1,c=o.isRequired?"required":"",h=this.props.index%2==0?t.evenBgColor:t.oddBgColor;return i.exports.createElement("g",{className:`attribute ${c}`,id:e.id,onClick:this.onClicked.bind(this),onDoubleClick:this.onDoubleClicked.bind(this)},i.exports.createElement("rect",{x:n,y:a,width:s,height:t.lineHeight,stroke:"transparent",fill:h}),i.exports.createElement("text",{className:"attribute-name",x:n+t.padding,y:l},o.name),i.exports.createElement("text",{className:"attribute-type",x:n+s-t.padding,y:l},o.type))}onClicked(t){t.stopPropagation(),this.props.ui.interactor.onAttributeClicked(this.props.attribute,t)}onDoubleClicked(t){t.stopPropagation(),this.props.ui.interactor.onAttributeDoubleClicked(this.props.attribute,t)}}class Dt extends i.exports.Component{constructor(t){super(t)}render(){const t=this.props.config,e=this.props.entity,s=e.width/2,o=e.left,n=this.props.y,a=this.props.config.iconSize,l={transform:`translate(${o+s/2-a/2}px,${n}px)`};return i.exports.createElement("g",{className:"new-button",id:`${e.id}-new-attribute`,onMouseDown:this.onClicked.bind(this)},i.exports.createElement("rect",{x:o,y:n,width:s,height:t.lineHeight,stroke:"transparent"}),i.exports.createElement("g",{className:"icon-container",style:l},i.exports.createElement(m.PlusAttribute,null)))}onClicked(t){t.stopPropagation(),this.props.ui.interactor.onNewAttributeClicked(this.props.entity)}}class It extends i.exports.Component{constructor(t){super(t)}render(){const t=this.props.config,e=this.props.entity,s=e.width/2,o=e.left+s,n=this.props.y,a=this.props.config.iconSize,l={transform:`translate(${o+s/2-a/2}px,${n}px)`};return i.exports.createElement("g",{className:"new-button",id:`${e.id}-new-attribute`,onMouseDown:this.onMouseDown.bind(this),onClick:this.onClicked.bind(this)},i.exports.createElement("rect",{x:o,y:n,width:s,height:t.lineHeight,stroke:"transparent"}),i.exports.createElement("g",{className:"icon-container",style:l},i.exports.createElement(m.PlusAssociation,null)))}onMouseDown(t){t.stopPropagation(),this.props.ui.interactor.onNewAssociationPressed(this.props.entity)}onClicked(t){t.stopPropagation(),alert("Drag this button to create a new association")}}class Ot extends i.exports.Component{constructor(t){super(t)}render(){const t=this.props.config,e=this.props.entity,[s,o]=e.size,n=e.state,a=t.lineHeight,l=t.borderSize,c=t.color(n.color);let h=0,d=n.y;const x=n.y+a/2+1,N=e.mapAttributes(U=>(d+=a,h+=1,i.exports.createElement($t,{key:U.id,config:t,ui:this.props.ui,width:s-2*l,x:n.x+l,y:d,index:h,attribute:U})));return d+=a,d=Math.max(d,n.y+o-t.lineHeight),i.exports.createElement("g",{className:"entity",id:e.id,"data-color":e.state.color,onClick:this.onClicked.bind(this),onDoubleClick:this.onDoubleClicked.bind(this),onMouseDown:this.onMouseDown.bind(this)},i.exports.createElement("rect",{className:"entity-background",x:n.x,y:n.y,width:s,height:o,stroke:"transparent",fill:c}),i.exports.createElement("rect",{className:"entity-name-bar",x:n.x,y:n.y,width:s,height:a,stroke:"transparent",fill:"transparent"})," ",i.exports.createElement("text",{className:"entity-name",x:n.x+s/2,y:x},n.name),i.exports.createElement("rect",{className:"attributes-background",width:s-2*l,x:n.x+l,y:n.y+a,height:t.minEntitySize-a-l}),N,i.exports.createElement(Dt,{config:t,ui:this.props.ui,y:d,entity:e}),i.exports.createElement(It,{config:t,ui:this.props.ui,y:d,entity:e}))}onClicked(t){this.props.ui.interactor.onEntityClicked(this.props.entity,t)}onMouseDown(t){t.stopPropagation(),this.props.ui.interactor.onEntityMouseDown(this.props.entity,t)}onDoubleClicked(t){this.props.ui.interactor.onEntityDoubleClicked(this.props.entity,t)}}class tt extends i.exports.Component{render(){var a;const t=this.props.path,e=this.props.fromSide,s=this.props.toSide;let o=!1,n={fromId:"",fromArity:"",toId:"",toArity:""};if(this.props.association){o=this.props.ui.selection.isAssociationSelected(this.props.association);const l=this.props.association.sides;n={fromId:l[0].entityId,fromArity:l[0].arity,toId:l[1].entityId,toArity:l[1].arity}}return i.exports.createElement("g",{className:`association ${o?"selected":""}`,id:(a=this.props.association)==null?void 0:a.id,"data-from-id":n.fromId,"data-from-arity":n.fromArity,"data-to-id":n.toId,"data-to-arity":n.toArity,onMouseDown:this.onClicked.bind(this)},i.exports.createElement("polyline",{className:"main invisible",points:t.svgPoints}),i.exports.createElement("polyline",{className:"main line",points:t.svgPoints}),e.arity=="many"&&this.renderChickenFoot(t.firstPoint,t.fromDir),s.arity=="many"&&this.renderChickenFoot(t.lastPoint,t.toDir))}renderChickenFoot(t,e){const s=this.props.config.gridSize;let o=[];switch(e){case"n":o=[{x:t.x-s+1,y:t.y+1},{x:t.x,y:t.y-s},{x:t.x+s-1,y:t.y+1}];break;case"s":o=[{x:t.x-s+1,y:t.y-1},{x:t.x,y:t.y+s},{x:t.x+s-1,y:t.y-1}];break;case"e":o=[{x:t.x-1,y:t.y-s+1},{x:t.x+s,y:t.y},{x:t.x-1,y:t.y+s-1}];break;case"w":o=[{x:t.x+1,y:t.y-s+1},{x:t.x-s,y:t.y},{x:t.x+1,y:t.y+s-1}];break}const n=o.map(a=>`${a.x},${a.y}`).join(" ");return i.exports.createElement("polyline",{className:"foot line",key:e,points:n})}onClicked(t){this.props.association&&(t.stopPropagation(),this.props.ui.interactor.onAssociationClicked(this.props.association))}}const zt=["n","s","e","w"];function X(r,t){return t=="s"||t=="n"?r.x:r.y}function Tt(r,t,e){return t=="s"||t=="n"?{x:e,y:r.y}:{x:r.x,y:e}}function Bt(r,t){return t=="s"||t=="n"?[r.left,r.right]:[r.top,r.bottom]}class Zt{constructor(t,e,s){this.id=t,this.fromId=e,this.toId=s,this.points=[],this.fromDir="e",this.toDir="e"}get svgPoints(){return this.points.map(t=>`${t.x},${t.y}`).join(" ")}get firstPoint(){return this.points[0]}get lastPoint(){return this.points[this.points.length-1]}get bounds(){return D(this.points)}}class et{constructor(t){this.config=t,this.rects={},this.lines=[]}addLine(t,e,s,o,n){this.rects[e]=s,this.rects[o]=n,this.lines.push(new Zt(t,e,o))}findEdge(t,e,s,o){const n=Pt(s);let a=null;const l=this.config.gridSize;return(a=k(t,[n.nw,n.ne]))?(a={x:Math.min(Math.max(a.x,s.left+l),s.right-l),y:a.y},e.points[o]=S(a),"n"):(a=k(t,[n.ne,n.se]))?(a={x:a.x,y:Math.min(Math.max(a.y,s.top+l),s.bottom-l)},e.points[o]=S(a),"e"):(a=k(t,[n.se,n.sw]))?(a={x:Math.min(Math.max(a.x,s.left+l),s.right-l),y:a.y},e.points[o]=S(a),"s"):(a=k(t,[n.sw,n.nw]))?(a={x:a.x,y:Math.min(Math.max(a.y,s.top+l),s.bottom-l)},e.points[o]=S(a),"w"):null}squareOut(t,e,s){const o=this.config.gridSize,n=t.points,a=[t.fromDir,t.toDir].sort().join(""),l=(n[0].x+n[1].x)/2,c=(n[0].y+n[1].y)/2;switch(a){case"ew":c>=e.top+o&&c>=s.top+o&&c<=e.bottom-o&&c<=s.bottom-o?(t.points[0]={x:n[0].x,y:c},t.points[1]={x:n[1].x,y:c}):t.points=[n[0],{x:l,y:n[0].y},{x:l,y:n[1].y},n[1]];return;case"ns":l>=e.left+o&&l>=s.left+o&&l<=e.right-o&&l<=s.right-o?(t.points[0]={x:l,y:n[0].y},t.points[1]={x:l,y:n[1].y}):t.points=[n[0],{x:n[0].x,y:c},{x:n[1].x,y:c},n[1]];return;case"en":t.points=[n[0],{x:Math.max(n[0].x,n[1].x),y:Math.min(n[0].y,n[1].y)},n[1]];return;case"nw":t.points=[n[0],{x:Math.min(n[0].x,n[1].x),y:Math.min(n[0].y,n[1].y)},n[1]];return;case"es":t.points=[n[0],{x:Math.max(n[0].x,n[1].x),y:Math.max(n[0].y,n[1].y)},n[1]];return;case"sw":t.points=[n[0],{x:Math.min(n[0].x,n[1].x),y:Math.max(n[0].y,n[1].y)},n[1]];return;default:throw`Don't know how to square out directions '${a}'`}}spreadSides(t,e,s,o){const n=Bt(s,o),a=this.config.gridSize,l=[];for(let c of t)c.fromId==e&&c.fromDir==o&&l.push({index:0,v:X(c.firstPoint,o),line:c}),c.toId==e&&c.toDir==o&&l.push({index:c.points.length-1,v:X(c.lastPoint,o),line:c});if(l.length>1){l.sort((h,d)=>h.v-d.v);let c=n[1]-n[0];for(let h=0;h<l.length-1;h++)c=Math.min(c,l[h+1].v-l[h].v);if(c<a){const h=(n[1]-n[0])/l.length;for(let d in l){const x=l[d];x.line.points[x.index]=Tt(x.line.points[x.index],o,n[0]+(parseInt(d)+.5)*h)}}}}layout(){let t=[];for(let e of this.lines){const s=this.rects[e.fromId],o=this.rects[e.toId];e.points=[W(s),W(o)];const n=[e.points[0],e.points[1]];let a=null,l=!0;if((a=this.findEdge(n,e,s,0))?e.fromDir=a:l=!1,(a=this.findEdge(n,e,o,1))?e.toDir=a:l=!1,!l)continue;const c=e.bounds;(c.width>this.config.gridSize||c.height>this.config.gridSize)&&t.push(e)}Object.entries(this.rects).forEach(e=>{for(let s of zt)this.spreadSides(t,e[0],e[1],s)});for(let e of t){const s=this.rects[e.fromId],o=this.rects[e.toId];this.squareOut(e,s,o)}return t}}class qt extends i.exports.Component{constructor(t){super(t)}render(){const t=this.props.config,e=this.props.schema,s=e.mapEntities(c=>(c.computeSize(t),i.exports.createElement(Ot,{key:c.id,config:this.props.config,ui:this.props.ui,entity:c}))),o=new et(t);e.mapAssociations(c=>{const h=c.entities;o.addLine(c.id,h[0].id,h[0],h[1].id,h[1])});const a=o.layout().map(c=>{const h=e.getAssociation(c.id),d=h.sides;return h.linePath=c,i.exports.createElement(tt,{key:h.id,config:this.props.config,ui:this.props.ui,path:c,fromSide:d[0],toSide:d[1],association:h})}),l=`
		.entity {
		}
		.entity-name {
			font: bold ${t.fontSize}px ${t.fontFamily};
			fill: #ffffff;
			text-anchor: middle;
			dominant-baseline: middle;
			text-shadow: 0 1px 0 rgba(0, 0, 0, 0.5);
		}
		.entity-background {
			rx: ${t.entityRadius};
		}
		.attributes-background {
			fill: ${t.evenBgColor};
			rx: 2;
		}
		.attribute-name {
			font: ${t.fontSize}px ${t.fontFamily};
			fill: ${t.fgColor};
			text-anchor: start;
			dominant-baseline: middle;
		}
		.attribute-type {
			font: ${t.fontSize}px ${t.fontFamily};
			fill: ${t.primaryColor};
			text-anchor: end;
			dominant-baseline: middle;
		}
		.attribute.required .attribute-name {
			font: bold ${t.fontSize}px ${t.fontFamily};
		}
		.new-button > rect {
			fill: transparent;
			rx: ${t.entityRadius};
		}
		.new-button svg g rect, .new-button svg g path {
			fill: ${t.hintFgColor};
		}
		.association polyline.line {
			stroke: ${t.fgColor};
			fill: none;
			stroke-width: 2px;
		}
		.association polyline.invisible {
			stroke-width: ${t.lineHeight};
			fill: none;
			stroke: transparent;
		}
		`;return i.exports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"3000",height:"3000",id:"document"},i.exports.createElement("style",null,l),i.exports.createElement("g",{id:"associations"},a),i.exports.createElement("g",{id:"entities"},s))}}const I=class{constructor(r,t,e){this.state=t,e?(this.id=e,I.bumpCount(r,e)):this.id=I.getId(r)}static newGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var t=Math.random()*16|0,e=r=="x"?t:t&3|8;return e.toString(16)})}static getId(r){return r=="schema"?this.newGuid():(this.idCounts[r]?this.idCounts[r]+=1:this.idCounts[r]=1,`${r}-${this.idCounts[r]}`)}static bumpCount(r,t){const e=t.split("-");if(e.length>1){const s=parseInt(e[1]);this.idCounts[r]?this.idCounts[r]=Math.max(this.idCounts[r],s):this.idCounts[r]=s+1}}};let v=I;v.idCounts={};class Ut{constructor(t,e){this.ui=t,this.config=e,this.actionSets=[],this.index=-1}numActions(){return this.actionSets.length}pushAction(t){this.pushSet(new Set([t]))}pushActions(t){this.pushSet(new Set(t))}pushSet(t){this.index>=this.numActions()&&(this.actionSets=this.actionSets.slice(0,this.index)),this.actionSets.push(t),this.index=this.actionSets.length-1,this.applySet(t),console.log(`action history at ${this.index}`)}applySet(t){t.forEach(e=>{e.apply(this.config,this.ui)}),this.ui.requestRender(u.RenderType.App)}unapplySet(t){t.forEach(e=>{e.unapply(this.config,this.ui)}),this.ui.requestRender(u.RenderType.App)}canUndo(){return this.index>-1}undo(){if(console.log("undo"),this.index<0)return!1;const t=this.actionSets[this.index];return this.unapplySet(t),this.ui.requestRender(u.RenderType.App),this.index-=1,console.log(`action history at ${this.index}`),!0}canRedo(){return this.index<this.numActions()-1}redo(){if(console.log("redo"),this.index>=this.numActions()-1)return!1;this.index+=1;const t=this.actionSets[this.index];return this.applySet(t),console.log(`action history at ${this.index}`),!0}}class y{}class A extends v{constructor(t,e,s=null){super("attribute",e,s);this.entity=t,this.position=new b(0,0),t.registerAttribute(this)}static fromRaw(t,e){const s=g.fromRaw(e);return new A(t,s)}get raw(){return g.toRaw(this.state)}}class g{constructor(t,e="text",s=!1){this.name=t,this.type=e,this.isRequired=s}static fromRaw(t){const e=t.split(":");let s=e[0].trim(),o="text";e.length>1&&(o=e[1].trim());let n=!1;return s.indexOf("*")>-1&&(n=!0,s=s.replace(/\*/g,"")),new g(s,o,n)}static toRaw(t){const e=t.isRequired?"*":"";return`${t.name}${e}: ${t.type}`}}class Vt extends y{constructor(t,e,s){super();this.attribute=t,this.fromState=e,this.toState=s}apply(){this.attribute.state=this.toState}unapply(){this.attribute.state=this.fromState}hasChanges(){return g.toRaw(this.fromState)!=g.toRaw(this.toState)}}class jt extends y{constructor(t,e){super();this.entity=t,this.raw=e}apply(){this.attribute=this.entity.newAttributeFromRaw(this.raw)}unapply(){this.attribute&&this.entity.removeAttribute(this.attribute.id)}hasChanges(){return this.raw.length>0}}class Wt extends y{constructor(t){super();this.attribute=t,this.entity=t.entity}apply(){this.entity.removeAttribute(this.attribute.id)}unapply(){this.attribute=this.entity.newAttributeFromRaw(this.attribute.raw)}hasChanges(){return!0}}const it=["left","right","horizontalCenter","top","bottom","verticalCenter"];class Xt extends v{constructor(t,e=new Ht,s=null){super("entity",e,s);this.schema=t,this.attributes={},this.size=[0,0],t.registerEntity(this)}computeSize(t){let e=t.measureText(this.state.name,"bold").width+2*t.padding;this.mapAttributes(o=>{let n=t.measureText(o.state.name,"bold").width+t.measureText(o.state.type).width+4*t.padding;e=Math.max(e,n)});const s=(this.numAttributes()+2)*t.lineHeight;return this.size=[Math.max(t.minEntitySize,t.snapUpEven(e)),Math.max(t.minEntitySize,t.snapUpEven(s))]}get width(){return this.size[0]}get height(){return this.size[1]}moveTo(t,e){this.state.x=t,this.state.y=e}get left(){return this.state.x}get right(){return this.state.x+this.size[0]}get horizontalCenter(){return this.state.x+this.size[0]/2}get top(){return this.state.y}get bottom(){return this.state.y+this.size[1]}get verticalCenter(){return this.state.y+this.size[1]/2}getPosition(t){switch(t){case"left":return this.left;case"right":return this.right;case"horizontalCenter":return this.horizontalCenter;case"top":return this.top;case"bottom":return this.bottom;case"verticalCenter":return this.verticalCenter}}snapPosition(t){this.moveTo(t.snapNearest(this.state.x),t.snapNearest(this.state.y))}registerAttribute(t){this.attributes[t.id]=t}removeAttribute(t){delete this.attributes[t]}numAttributes(){return Object.entries(this.attributes).length}newAttribute(t,e=null){return new A(this,t,e)}newAttributeFromRaw(t){return A.fromRaw(this,t)}getAttribute(t){return this.attributes[t]}attributesInOrder(){return Object.entries(this.attributes).sort((e,s)=>e[1].state.name>s[1].state.name?1:-1).map(e=>e[1])}mapAttributes(t){return this.attributesInOrder().map(t)}firstAttribute(){return this.attributesInOrder()[0]}lastAttribute(){const t=this.attributesInOrder();return t[t.length-1]}previousAttribute(t){let e;return this.attributesInOrder().reverse().forEach(s=>{!e&&s.state.name<t.state.name&&(e=s)}),e}nextAttribute(t){let e;return this.attributesInOrder().forEach(s=>{!e&&s.state.name>t.state.name&&(e=s)}),e}isWithin(t){return new z(this.state.x,this.state.y,this.size[0],this.size[1]).isWithin(t)}}class Ht{constructor(){this.name="",this.x=0,this.y=0,this.color="blue"}}class Kt extends y{constructor(t,e){super();this.schema=t,this.state=e}apply(t,e){this.entity?this.schema.addEntity(this.entity):this.entity=this.schema.newEntity(this.state),e.selection.addEntity(this.entity),this.entity.state.name.length||e.interactor.editEntityName(this.entity)}unapply(t,e){this.entity&&this.schema.removeEntity(this.entity.id)}hasChanges(){return!0}}class T extends y{constructor(t,e,s){super();this.entity=t,this.fromState=e,this.toState=s}apply(t,e){this.entity.state=this.toState}unapply(t,e){this.entity.state=this.fromState}hasChanges(){return this.fromState.x!=this.toState.x||this.fromState.y!=this.toState.y||this.fromState.name!=this.toState.name}}class Gt extends y{constructor(t){super();this.entity=t,this.schema=t.schema}apply(t,e){this.schema.removeEntity(this.entity.id)}unapply(t,e){this.schema.addEntity(this.entity)}hasChanges(){return!0}}class st extends v{constructor(t,e,s=null){super("association",e,s);this.schema=t,this.linePath=null,t.registerAssociation(this)}get entities(){return Object.entries(this.state.sides).map(t=>this.schema.getEntity(t[0]))}get sides(){return Object.entries(this.state.sides).map(t=>t[1])}}function H(r){return r=="one"?"many":"one"}class O{constructor(t,e="one"){this.entityId=t,this.arity=e}}class M{constructor(t,e){this.sides={},this.sides[t.entityId]=t,this.sides[e.entityId]=e}}class Yt{constructor(t){this.schema=t,this.sides=[]}add(t,e="one"){return this.sides.push(new O(t.id,e)),this}build(){if(this.sides.length!=2)throw"Must call add() twice!";return new st(this.schema,new M(this.sides[0],this.sides[1]))}}class Jt extends y{constructor(t,e){super();this.schema=t,this.state=e}apply(t,e){this.association?this.schema.addAssociation(this.association):this.association=this.schema.newAssociation(this.state),e.selection.addAssociation(this.association,!1)}unapply(t,e){this.association&&this.schema.removeAssociation(this.association.id)}hasChanges(){return!0}}class _t extends y{constructor(t,e,s){super();this.association=t,this.fromState=e,this.toState=s}apply(t,e){this.association.state=this.toState}unapply(t,e){this.association.state=this.fromState}hasChanges(){const{fromFirstSide:t,fromLastSide:e}=this.fromState.sides,{toFirstSide:s,toLastSide:o}=this.toState.sides;return t.arity!=s.arity||e.arity!=o.arity}}class K extends y{constructor(t){super();this.association=t,this.schema=t.schema}apply(t,e){this.schema.removeAssociation(this.association.id)}unapply(t,e){this.schema.addAssociation(this.association)}hasChanges(){return!0}}class Qt{constructor(t){this.ui=t,this.mode=0,this.entities={},this.associations={}}clear(){return this.entities={},this.associations={},this.ui.requestRender(u.RenderType.App),this}numEntites(){return Object.entries(this.entities).length}isEntitySelected(t){return this.entities[t.id]!=null}addEntity(t,e=!1){!e&&this.mode==0&&this.clear(),this.entities[t.id]=t,this.ui.requestRender(u.RenderType.App)}selectAll(){this.ui.schema.mapEntities(t=>{this.entities[t.id]=t}),this.ui.requestRender(u.RenderType.App)}get allEntities(){return Object.entries(this.entities).map(t=>t[1])}mapEntities(t){return Object.entries(this.entities).map(e=>t(e[1]))}deleteEntities(){const t=Object.keys(this.entities),e=this.mapEntities(s=>new Gt(s));for(let s of t)this.ui.schema.mapAssociations(o=>{for(let n of o.sides)n.entityId==s&&e.push(new K(o))});this.ui.history.pushActions(e),this.clear()}numAssociations(){return Object.entries(this.associations).length}isAssociationSelected(t){return this.associations[t.id]!=null}addAssociation(t,e=!1){!e&&this.mode==0&&(this.associations={}),this.associations[t.id]=t,this.ui.requestRender(u.RenderType.App)}mapAssociations(t){return Object.entries(this.associations).map(e=>t(e[1]))}get allAssociations(){return Object.entries(this.associations).map(t=>t[1])}deleteAssociations(){const t=this.mapAssociations(e=>new K(e));this.ui.history.pushActions(t),this.clear()}renderOverlay(){const t=this.mapEntities(e=>{const s=e.size,o={width:s[0]+2,height:s[1]+2,top:e.top-1,left:e.left-1};return i.exports.createElement("div",{className:"entity-overlay",key:e.id,style:o})});return i.exports.createElement("div",{className:"selection"},t)}}class te{constructor(t,e){this.ui=t,this.config=e}onCanvasMouseDown(t){this.proxy||(this.proxy=new ee(this,t))}onCanvasMouseMove(t){t.buttons&&this.proxy&&(this.proxy.onMouseMove(t),this.ui.requestRender(u.RenderType.Overlay))}onCanvasMouseUp(t){this.proxy&&this.proxy.onMouseUp(t)&&this.clearProxy()}onCanvasDoubleClicked(t){this.clearProxy(),this.ui.selection.clear()}onEntityMouseDown(t,e){this.proxy||(this.ui.selection.addEntity(t,e.shiftKey||this.ui.selection.isEntitySelected(t)),this.proxy=new ie(this,e))}onEntityClicked(t,e){}onEntityDoubleClicked(t,e){this.editEntityName(t),e.stopPropagation()}onAttributeClicked(t,e){}onAttributeDoubleClicked(t,e){this.editAttribute(t),e.stopPropagation()}editEntityName(t){this.clearProxy(),this.proxy=new $(this,t)}editAttribute(t){this.clearProxy(),this.proxy=new E(this,t)}editFirstAttribute(t){let e=t.firstAttribute();e?this.proxy=new E(this,e):this.addNewAttribute(t),this.ui.requestRender(u.RenderType.Viewport)}editLastAttribute(t){let e=t.lastAttribute();e?this.proxy=new E(this,e):this.proxy=new $(this,t),this.ui.requestRender(u.RenderType.Viewport)}editPreviousAttribute(t){let e=t.entity.previousAttribute(t);e?this.proxy=new E(this,e):this.proxy=new $(this,t.entity),this.ui.requestRender(u.RenderType.Viewport)}editNextAttribute(t){let e=t.entity.nextAttribute(t);e?this.proxy=new E(this,e):this.onNewAttributeClicked(t.entity),this.ui.requestRender(u.RenderType.Viewport)}addNewAttribute(t){this.proxy=new re(this,t),this.ui.requestRender(u.RenderType.Viewport)}onNewAttributeClicked(t){this.addNewAttribute(t)}onNewAssociationPressed(t){this.clearProxy(),this.proxy=new oe(this,t)}onAssociationClicked(t){this.ui.selection.clear().addAssociation(t)}beginNewEntity(){this.proxy=new ne(this,this.ui.schema),this.ui.requestRender(u.RenderType.Viewport)}render(){return this.proxy?this.proxy.renderOverlay():i.exports.createElement("div",{className:"select-interactor"})}afterRender(){this.proxy&&this.proxy.afterRender()}eventRelativePosition(t){const s=t.currentTarget.getBoundingClientRect();return new b(t.clientX-s.left,t.clientY-s.top)}clearProxy(){this.proxy&&(this.proxy=void 0,this.ui.requestRender(u.RenderType.App))}}class F{constructor(t){this.interactor=t,this.config=t.config}onMouseMove(t){return!1}onMouseUp(t){return!1}afterRender(){}}class ee extends F{constructor(t,e){super(t);this.hasMoved=!1,this.selection=t.ui.selection,e.shiftKey||this.selection.clear(),this.initialPos=this.interactor.eventRelativePosition(e),this.range=D([this.initialPos])}updateRange(t){const e=this.interactor.eventRelativePosition(t);this.range=D([e,this.initialPos])}onMouseMove(t){return this.updateRange(t),this.hasMoved=!0,!1}onMouseUp(t){return this.updateRange(t),this.interactor.ui.schema.mapEntities(e=>{e.isWithin(this.range)&&this.selection.addEntity(e,!0)}),!0}renderOverlay(){if(!this.hasMoved)return i.exports.createElement("div",null);const t={left:this.range.x,top:this.range.y,width:this.range.width,height:this.range.height};return i.exports.createElement("div",{className:"select-interactor rubber-band",style:t})}}class ie extends F{constructor(t,e){super(t);this.initialStates={},this.guides=[],this.selection=t.ui.selection,this.selection.mapEntities(s=>{this.initialStates[s.id]=p({},s.state)}),this.diffPos=new b(0,0)}onMouseMove(t){return this.diffPos=Q(this.diffPos,{x:t.movementX,y:t.movementY}),this.selection.mapEntities(e=>{let s=this.initialStates[e.id];e.moveTo(s.x+this.diffPos.x,s.y+this.diffPos.y)}),this.computeGuides(),this.interactor.ui.requestRender(u.RenderType.Viewport),!1}onMouseUp(t){const e=this.selection.mapEntities(s=>(s.snapPosition(this.interactor.config),new T(s,this.initialStates[s.id],s.state)));return this.guides=[],e.map(s=>s.hasChanges()).includes(!0)?this.interactor.ui.history.pushActions(e):this.interactor.ui.requestRender(u.RenderType.Viewport),!0}renderOverlay(){return i.exports.createElement("div",{className:"select-interactor"},this.guides.map((t,e)=>i.exports.createElement(se,C(p({},t),{key:`guide-${e}`}))))}computeGuides(){this.guides=[];const t=this.interactor.ui.schema.filterEntities(e=>!this.selection.isEntitySelected(e));for(let e of it){let s=this.selection.mapEntities(o=>this.interactor.config.snapNearest(o.getPosition(e)));s=[...new Set(s)],t.forEach(o=>{const n=o.getPosition(e);s.indexOf(n)>-1&&this.guides.push({positionType:e,xy:n})})}}}class se extends i.exports.Component{render(){const t=this.props.positionType,e=it.indexOf(t)<3?"left":"top",s={};return s[e]=this.props.xy,i.exports.createElement("div",{className:`guide ${t}`,style:s})}}class ne extends F{constructor(t,e){super(t);this.schema=e}onMouseMove(t){return this.position=this.interactor.eventRelativePosition(t),!1}onMouseUp(t){if(!this.position)return!0;const e={name:"",x:this.config.snapNearest(this.position.x-this.config.minEntitySize/2),y:this.config.snapNearest(this.position.y-this.config.minEntitySize/2),color:"blue"},s=new Kt(this.schema,e);return this.interactor.ui.history.pushAction(s),!1}renderOverlay(){if(!this.position)return i.exports.createElement("div",{id:"new-entity-proxy"});const t=this.interactor.config.iconSize,e={top:this.position.y-t/2,left:this.position.x-t/2};return i.exports.createElement("div",{id:"new-entity-proxy",style:e},i.exports.createElement(m.PlusEntity,null))}}class B extends F{constructor(t,e){super(t);this.entity=e,this.input=i.exports.createRef()}onKeyPress(t){switch(t.key){case"Enter":this.commit(t.currentTarget.value);return;case"Escape":this.interactor.clearProxy();return}}onKeyDown(t){switch(t.key){case"Escape":t.preventDefault(),this.interactor.clearProxy();return;case"ArrowUp":t.preventDefault(),this.onUp();return;case"ArrowDown":t.preventDefault(),this.onDown();return}}afterRender(){var t;(t=this.input.current)==null||t.focus()}renderOverlay(){const t=this.interactor.config,e=this.position,s={left:e.x,top:e.y,width:this.entity.width,height:t.lineHeight},o={width:"100%"};return i.exports.createElement("div",{className:this.className,key:this.key,style:s},i.exports.createElement("input",{type:"text",ref:this.input,defaultValue:this.defaultValue,placeholder:this.placeholder,style:o,onKeyPress:this.onKeyPress.bind(this),onKeyDown:this.onKeyDown.bind(this)}))}get placeholder(){return""}}class $ extends B{constructor(t,e){super(t,e);this.entity=e}get position(){return new b(this.entity.left,this.entity.top)}get className(){return"entity-name-field text-field"}get key(){return`edit-${this.entity.id}`}get defaultValue(){return this.entity.state.name}get placeholder(){return"Entity Name"}onUp(){this.interactor.addNewAttribute(this.entity)}onDown(){this.interactor.editFirstAttribute(this.entity)}commit(t){const e=p({},this.entity.state);if(e.name=t.trim(),e.name.length>0&&e.name!=this.entity.state.name){const s=new T(this.entity,this.entity.state,e);this.interactor.ui.history.pushAction(s)}this.interactor.clearProxy(),this.interactor.editFirstAttribute(this.entity)}}class E extends B{constructor(t,e){super(t,e.entity);this.attribute=e}get position(){return this.attribute.position}get className(){return"attribute-field text-field"}get key(){return`edit-${this.attribute.id}`}get defaultValue(){return this.attribute.raw}get placeholder(){return"name: type"}onUp(){this.interactor.editPreviousAttribute(this.attribute)}onDown(){this.interactor.editNextAttribute(this.attribute)}commit(t){const e=g.fromRaw(t);if(t.trim().length){const s=new Vt(this.attribute,this.attribute.state,e);s.hasChanges()&&this.interactor.ui.history.pushAction(s)}else{const s=new Wt(this.attribute);this.interactor.ui.history.pushAction(s)}this.interactor.clearProxy(),this.interactor.editNextAttribute(this.attribute)}}class re extends B{constructor(t,e){super(t,e);this.entity=e}get position(){return{x:this.entity.left,y:this.entity.top+(this.entity.numAttributes()+1)*this.interactor.config.lineHeight}}get className(){return"attribute-field text-field"}get key(){return`new-attribute-${this.entity.id}-${new Date().getUTCMilliseconds()}`}get defaultValue(){return""}get placeholder(){return"name: type"}onUp(){this.interactor.editLastAttribute(this.entity)}onDown(){this.interactor.addNewAttribute(this.entity)}commit(t){const e=new jt(this.entity,t);e.hasChanges()?(this.interactor.ui.history.pushAction(e),this.interactor.addNewAttribute(this.entity)):this.interactor.clearProxy()}}class oe extends F{constructor(t,e){super(t);this.fromEntity=e,this.schema=this.interactor.ui.schema}onMouseMove(t){return this.position=this.interactor.eventRelativePosition(t),this.toEntity=this.schema.entityAt(this.position),!1}onMouseUp(t){if(!this.position||!this.toEntity)return!0;const e=new M(new O(this.fromEntity.id,"one"),new O(this.toEntity.id,"many")),s=new Jt(this.schema,e);return this.interactor.ui.history.pushAction(s),!0}renderOverlay(){if(this.position){const t={arity:"one"},e={arity:"many"},s=new et(this.interactor.config),o=this.config.gridSize*2,n=new z(this.position.x-o/2,this.position.y-o/2,o,o);s.addLine("new-association",this.fromEntity.id,this.fromEntity,"dangling",n);const a=s.layout();if(a.length)return i.exports.createElement("svg",null,i.exports.createElement(tt,{config:this.interactor.config,ui:this.interactor.ui,fromSide:t,toSide:e,path:a[0]}))}return i.exports.createElement("div",null)}}class ae{constructor(t,e){this.ui=t,this.config=e,document.addEventListener("keydown",s=>{s.target.tagName!="INPUT"&&((s.metaKey||s.ctrlKey)&&this.onCommandKey(s.key,s.shiftKey)&&s.preventDefault(),s.key=="Backspace"&&(this.ui.selection.numEntites()?(this.ui.selection.deleteEntities(),s.stopPropagation()):this.ui.selection.numAssociations()&&(this.ui.selection.deleteAssociations(),s.stopPropagation())))}),document.addEventListener("keypress",s=>{})}onCommandKey(t,e){switch(t){case"a":return this.ui.selection.selectAll(),!0;case"z":return e?this.ui.history.redo():this.ui.history.undo(),!0}return!1}}class le{constructor(t,e){this.type=t,this.component=e}}class f{constructor(t,e){this.config=t,this.schema=e,this.nextRenderType=f.RenderType.None,this.renderListeners=[],this.selection=new Qt(this),this.interactor=new te(this,t),this.history=new Ut(this,t),this.keymap=new ae(this,t)}requestRender(t){this.nextRenderType==f.RenderType.None&&requestAnimationFrame(this.onAnimationFrame.bind(this)),t>this.nextRenderType&&(this.nextRenderType=t)}listenForRender(t,e){this.renderListeners.push(new le(t,e))}onAnimationFrame(){for(let t of this.renderListeners)t.type<=this.nextRenderType&&t.component.forceUpdate();this.nextRenderType=f.RenderType.None,this.interactor.afterRender()}}(r=>{(t=>{t[t.None=0]="None",t[t.Overlay=1]="Overlay",t[t.Viewport=2]="Viewport",t[t.App=3]="App"})(r.RenderType||(r.RenderType={}))})(f||(f={}));var u=f;class ce extends i.exports.Component{constructor(t){super(t);this.props.ui.listenForRender(u.RenderType.Overlay,this)}render(){const t=this.props.ui;return i.exports.createElement("div",{className:"overlay-plane"},t.selection.renderOverlay(),t.interactor.render())}}class he extends i.exports.Component{constructor(t){super(t)}componentDidMount(){this.props.ui.listenForRender(u.RenderType.Viewport,this)}render(){const{config:t,schema:e,ui:s}=this.props;return i.exports.createElement("div",{id:"viewport"},i.exports.createElement("div",{className:`canvas grid-${t.gridSize}`,onMouseDown:this.onMouseDown.bind(this),onMouseMove:this.onMouseMove.bind(this),onMouseUp:this.onMouseUp.bind(this),onDoubleClick:this.onDoubleClicked.bind(this)},i.exports.createElement("div",{className:"document-plane",key:`document-${e.id}`},i.exports.createElement(qt,{config:t,ui:s,schema:e})),i.exports.createElement(ce,{key:`overlay-${e.id}`,config:t,ui:s})))}onMouseDown(t){this.props.ui.interactor.onCanvasMouseDown(t)}onMouseMove(t){this.props.ui.interactor.onCanvasMouseMove(t)}onMouseUp(t){this.props.ui.interactor.onCanvasMouseUp(t)}onDoubleClicked(t){this.props.ui.interactor.onCanvasDoubleClicked(t)}}class Z extends v{constructor(t=null){super("schema",new pe,t);this.entities={},this.associations={}}registerEntity(t){this.entities[t.id]=t}getEntity(t){return this.entities[t]}hasEntity(t){return!!this.entities[t]}addEntity(t){this.entities[t.id]=t}removeEntity(t){delete this.entities[t]}newEntity(t,e=null){return new Xt(this,t,e)}get allEntities(){return Object.entries(this.entities).map(t=>t[1])}filterEntities(t){return Object.entries(this.entities).filter(e=>t(e[1])).map(e=>e[1])}mapEntities(t){return Object.entries(this.entities).map(e=>t(e[1]))}entityAt(t){for(let e of this.allEntities)if(Nt(e,t))return e}registerAssociation(t){this.associations[t.id]=t}getAssociation(t){return this.associations[t]}addAssociation(t){this.associations[t.id]=t}removeAssociation(t){delete this.associations[t]}newAssociation(t,e=null){return new st(this,t,null)}buildAssociation(){return new Yt(this)}get allAssociations(){return Object.entries(this.associations).map(t=>t[1])}filterAssociations(t){return Object.entries(this.associations).filter(e=>t(e[1])).map(e=>e[1])}mapAssociations(t){return Object.entries(this.associations).map(e=>t(e[1]))}demo(t){const e=this.newEntity({name:"Foo",x:75,y:60,color:"blue"});e.newAttributeFromRaw("first name*"),e.newAttributeFromRaw("last name"),e.newAttributeFromRaw("created at : datetime"),e.newAttributeFromRaw("address"),e.snapPosition(t);const s=this.newEntity({name:"Bar",x:500,y:60,color:"cyan"});s.newAttributeFromRaw("time : datetime"),s.newAttributeFromRaw("number* : integer"),s.newAttributeFromRaw("description"),s.snapPosition(t);const o=this.newEntity({name:"Baz",x:75,y:400,color:"green"});o.newAttributeFromRaw("name*"),o.newAttributeFromRaw("width: integer"),o.newAttributeFromRaw("height: integer"),o.snapPosition(t),this.buildAssociation().add(e,"one").add(s,"many").build(),this.buildAssociation().add(e,"one").add(o,"many").build()}}class pe{}function ue(r){return r.filter((t,e)=>r.indexOf(t)===e)}class q extends i.exports.Component{constructor(t){super(t);this.selection=t.ui.selection}render(){let t=null;return this.selection.numEntites()?t=i.exports.createElement(de,p({},this.props)):this.selection.numAssociations()&&(t=i.exports.createElement(xe,p({},this.props))),i.exports.createElement("div",{id:"selection-menu",className:t?"show":""},t)}}class de extends q{constructor(t){super(t);this.state={showColorMenu:!1}}colorsToStripes(t){const s=(this.props.config.gridSize*2-4)/t.length,o=[];let n=0;for(let a of t){const l=this.props.config.color(a);o.push(`${l} ${n}px`),n+=s,o.push(`${l} ${n}px`)}return`repeating-linear-gradient(45deg, ${o.join(", ")})`}render(){var o;const t=this.props.config,e=ue(this.selection.mapEntities(n=>n.state.color)).sort();let s={background:`${t.color(e[0])}`};return e.length>1&&(s.background=this.colorsToStripes(e)),i.exports.createElement("div",{className:"content"},i.exports.createElement("a",{className:"action color"},i.exports.createElement("div",{className:"color-circle",style:s,onClick:this.toggleColorMenu.bind(this)})),i.exports.createElement("a",{className:"action alert",title:"Delete Entity(s)",onClick:this.delete.bind(this)},i.exports.createElement(m.Delete,null)),((o=this.state)==null?void 0:o.showColorMenu)&&i.exports.createElement(me,{config:this.props.config,onSelect:n=>this.changeColor(n)}))}toggleColorMenu(){var t;this.setState({showColorMenu:!((t=this.state)!=null&&t.showColorMenu)})}changeColor(t){this.setState({showColorMenu:!1});const e=this.selection.allEntities;let s=!1;for(let n of e)if(n.state.color!=t){s=!0;break}if(!s)return;const o=e.map(n=>{const a=C(p({},n.state),{color:t});return new T(n,n.state,a)});this.selection.ui.history.pushActions(o)}delete(){this.selection.deleteEntities()}}class me extends i.exports.Component{render(){const t=this.props.config,e=Object.entries(t.colors).map(s=>{const o={background:s[1]};return i.exports.createElement("a",{className:"action color",key:s[0],onClick:()=>this.props.onSelect(s[0])},i.exports.createElement("div",{className:"color-circle",style:o}))});return i.exports.createElement("div",{className:"color-menu"},e)}}class xe extends q{render(){const t=this.selection.allAssociations[0],e=t.sides,s=t.entities,o=e[0].arity=="many"?s[1].state.name:s[0].state.name,n=e[0].arity=="many"?s[0].state.name:s[1].state.name;return i.exports.createElement("div",{className:"content"},i.exports.createElement("div",{className:"one-name"},o),i.exports.createElement("div",{className:"arity"},"Has Many"),i.exports.createElement("div",{className:"many-name"},n),i.exports.createElement("a",{className:"action swap",title:"Swap Sides",onClick:()=>this.swapSides(t)},i.exports.createElement(m.SwapVertical,null)),i.exports.createElement("a",{className:"action alert",title:"Delete Association",onClick:this.delete.bind(this)},i.exports.createElement(m.Delete,null)))}swapSides(t){const e=t.sides,s=C(p({},e[0]),{arity:H(e[0].arity)}),o=C(p({},e[1]),{arity:H(e[1].arity)}),n=new M(s,o),a=new _t(t,t.state,n);this.selection.ui.history.pushAction(a)}delete(){this.selection.deleteAssociations()}}class G{constructor(t){this.schema=t}dump(t){const e=t.cloneNode(!0);console.log("view node",e);const s=Rt(this.schema.allEntities.map(n=>({x:n.left,y:n.top})));let o=Mt(this.schema.allEntities.map(n=>({x:n.right,y:n.bottom})));return console.log(`document goes from ${s.x},${s.y} to ${o.x},${o.y}`),o=Q(o,s),e.setAttribute("width",`${o.x}px`),e.setAttribute("height",`${o.y}px`),e.setAttribute("viewport",`0 0 ${o.x} ${o.y}`),e.querySelectorAll("g.icon-container").forEach(n=>{n.remove()}),e.outerHTML}download(t){}}class ye{constructor(t){this.config=t}warn(t){console.log(`WARN [Reader]: ${t}`)}read(t,e){const s=document.createElement("html");s.innerHTML=t;const o=e.length?e:null,n=new Z(o);return s.querySelectorAll("g.entity").forEach(a=>{this.parseEntity(n,a)}),s.querySelectorAll("g.association").forEach(a=>{this.parseAssociation(n,a)}),s.remove(),n}parseEntity(t,e){var d,x;const s=e.id,o=e.querySelector("rect.entity-name-bar");let n={x:0,y:0};o&&(n.x=parseInt(o.getAttribute("x")||"0"),n.y=parseInt(o.getAttribute("y")||"0"));let a="";const l=e.querySelector("text.entity-name");l!=null&&l.textContent&&(a=l.textContent);let c="blue";if((x=(d=e.dataset)==null?void 0:d.color)!=null&&x.length)try{c=e.dataset.color}catch{this.warn(`invalid color name ${e.dataset.color}`)}const h=t.newEntity({name:a,x:n.x,y:n.y,color:c},s);e.querySelectorAll("g.attribute").forEach(N=>{this.parseAttribute(h,N)})}parseAttribute(t,e){const s=e.id;let o="";const n=e.querySelector("text.attribute-name");n!=null&&n.textContent&&(o=n.textContent);let a="";const l=e.querySelector("text.attribute-type");l!=null&&l.textContent&&(a=l.textContent);let c=(e==null?void 0:e.classList.contains("required"))||!1;t.newAttribute({name:o,type:a,isRequired:c},s)}parseAssociation(t,e){var l,c,h,d;const s=e.id,o={entityId:((l=e.dataset)==null?void 0:l.fromId)||"",arity:((c=e.dataset)==null?void 0:c.fromArity)||"one"};if(!t.hasEntity(o.entityId)){this.warn(`No entity ${o.entityId}`);return}const n={entityId:((h=e.dataset)==null?void 0:h.toId)||"",arity:((d=e.dataset)==null?void 0:d.toArity)||"one"};if(!t.hasEntity(n.entityId)){this.warn(`No entity ${n.entityId}`);return}const a=new M(o,n);t.newAssociation(a,s)}}const fe="1.0.3";var Y="/DBoard/assets/demo.67f7d86e.png";const J="manifest";class R{constructor(){this.items={};const t=localStorage.getItem(J);if(t&&t.length)try{this.items=JSON.parse(t)}catch(e){console.log(`Error parsing raw manifest "${t}"`,e)}}addItem(t){const e=C(p({},t),{raw:void 0});this.items[t.id]?console.log("Replacing local manifest item",e):console.log("Adding local manifest item",e),this.items[t.id]=e}removeItem(t){delete this.items[t.id]}getItem(t){return this.items[t]}write(){localStorage.setItem(J,JSON.stringify(this.items))}get itemsInOrder(){return Object.entries(this.items).map(t=>t[1]).sort((t,e)=>(e.updatedAt||0)-(t.updatedAt||0))}loadItem(t){const e=localStorage.getItem(t.id);if(e)try{return JSON.parse(e)}catch(s){console.log("error parsing raw localstorage item",s,e)}return null}}class nt{constructor(t){this.meta=t}static existingById(t){const s=new R().getItem(t);if(s)switch(s.origin){case"localStorage":return new w(s);default:throw`Unknown origin '${s.origin}'`}else return new w("")}save(t){const e=new G(t),s=document.getElementById("document"),o=e.dump(s);this.saveRaw(t.id,o)}export(t){const e=new G(t),s=document.getElementById("document"),o=e.dump(s);this.exportRaw(o)}exportRaw(t){const e=document.createElement("a"),s=new Blob([t],{type:"image/svg+xml"});e.href=URL.createObjectURL(s),e.download=this.nameWithExtension,e.click(),e.remove()}get fileName(){const t=this.meta.name.split("/");return t[t.length-1]}set fileName(t){this.meta.name=t}get nameWithExtension(){return this.fileName.indexOf(".svg")>0?this.fileName:this.fileName+".svg"}get nameWithoutExtension(){return this.fileName.replace(/\.svg/i,"")}async load(t){const e=await this.loadRaw();return console.log("raw: ",e),new ye(t).read(e,this.meta.id)}}class w extends nt{constructor(t){t.id?super(t):super({id:"",name:t,origin:"localStorage",raw:void 0,updatedAt:0})}saveRaw(t,e){const s={id:t,name:this.nameWithoutExtension,raw:e,updatedAt:new Date().valueOf(),origin:"localStorage"};localStorage.setItem(t,JSON.stringify(s));const o=new R;o.addItem(s),o.write()}async loadRaw(){return new Promise((t,e)=>{if(this.meta.id.length){const s=new R().loadItem(this.meta);if(s&&s.raw){t(s.raw);return}}t("<svg></svg>")})}renderButton(){return i.exports.createElement("div",null,i.exports.createElement(m.BlankDocument,null),i.exports.createElement("h2",null,"Blank"),i.exports.createElement("p",null,"Create a new blank document"))}}class ge extends w{constructor(){super({id:"",raw:void 0,name:"",origin:"localStorage",updatedAt:0})}async loadRaw(){const t=document.createElement("input");return t.setAttribute("type","file"),t.setAttribute("accept",".svg"),new Promise((e,s)=>{t.addEventListener("change",()=>{const o=t.files;if(console.log(`selected ${o==null?void 0:o.length} files`),!o)alert("You must select an SVG file to upload!");else if(o.length==1){const n=o[0];this.meta.name=n.name,n.text().then(a=>{e(a)})}else alert("You must select only one SVG file to upload!");t.remove()},!1),t.click()})}renderButton(){return i.exports.createElement("div",null,i.exports.createElement(m.Upload,null),i.exports.createElement("h2",null,"Upload"),i.exports.createElement("p",null,"Upload an SVG file that was previously generated with DBoard"))}}class we extends w{constructor(){super({id:"demo",raw:void 0,name:"demo",origin:"localStorage",updatedAt:0})}async loadRaw(){return new Promise((t,e)=>{t(Y)})}async load(t){const e=new Z;return e.demo(t),new Promise(s=>{s(e)})}renderButton(){return i.exports.createElement("div",null,i.exports.createElement("img",{src:Y}),i.exports.createElement("h2",null,"Demo"),i.exports.createElement("p",null,"A demo document with existing entities and associations"))}}class Ce extends i.exports.Component{constructor(t){super(t);this.state={items:this.props.manifest.itemsInOrder}}dataUri(t){const e=t.replace(/\%09/g,"").replace(/\%0A/g,"");return`data:image/svg+xml;base64,${btoa(e)}`}render(){const t=this.state.items.map(e=>{const s=new Date(e.updatedAt||0),o=this.props.manifest.loadItem(e),n=o&&o.raw?this.dataUri(o.raw):"";return i.exports.createElement("a",{key:e.id,className:"item",onClick:()=>this.onItemClicked(e)},i.exports.createElement("div",{className:"name"},e.name),o&&o.raw&&i.exports.createElement("img",{className:"preview",src:n}),i.exports.createElement("div",{className:"updated-at"},s.toDateString()),i.exports.createElement("div",{className:"close",onClick:a=>{this.onRemoveItem(e),a.stopPropagation()}},i.exports.createElement(m.Close,null)))});return i.exports.createElement("div",{className:"manifest"},t)}onItemClicked(t){this.props.onSourceSelected(new w(t))}onRemoveItem(t){const e=this.props.manifest;confirm("Remove this document from the recent list?")&&(e.removeItem(t),e.write(),this.setState({items:e.itemsInOrder}))}}class Ee extends i.exports.Component{constructor(t){super(t);this.sources=[new w("untitled"),new ge,new we]}render(){const t=this.props.onPicked,e=this.sources.map((s,o)=>i.exports.createElement("a",{className:"source",key:`source-${o}`,onClick:()=>t(s)},s.renderButton()));return i.exports.createElement("div",{className:"source-picker-bg"},i.exports.createElement("div",{className:"source-picker"},i.exports.createElement("div",{className:"banner"},i.exports.createElement(_,null),i.exports.createElement("div",{className:"tagline"},"Open Source Data Modeler"),i.exports.createElement("div",{className:"version"},"Version ",fe)),i.exports.createElement("a",{className:"close",onClick:()=>this.props.onCanceled()},i.exports.createElement(m.Close,null)),i.exports.createElement("div",{className:"sources"},e),i.exports.createElement(Ce,{manifest:new R,onSourceSelected:s=>t(s)}),i.exports.createElement("div",{className:"footer"},i.exports.createElement("div",{className:"column"},i.exports.createElement("a",{href:"https://github.com/Terrier-Tech/DBoard",target:"_blank"},i.exports.createElement(m.Github,null),i.exports.createElement("span",null,"Source Code"))),i.exports.createElement("div",{className:"column"},i.exports.createElement("a",{href:"http://terrier.tech",target:"_blank"},i.exports.createElement(m.Terrier,null),i.exports.createElement("span",null,"\xA9 ",new Date().getFullYear()," Terrier Technologies"))))))}}class be extends i.exports.Component{constructor(t){super(t);this.config=new ut;const e=new Z,s=new u(this.config,e);s.listenForRender(u.RenderType.App,this);const o=location.hash;let n=new w("untitled");if(console.log(`hash: ${o}`),o.length>1){const a=o.substring(1);n=nt.existingById(a),this.reload(n)}this.state={ui:s,schema:e,source:n,pickSource:!0}}async reload(t){const e=await t.load(this.config),s=new u(this.config,e);s.listenForRender(u.RenderType.App,this),history.pushState(null,"",`#${e.id}`),this.setState({ui:s,schema:e,source:t,pickSource:!1})}open(){this.setState({pickSource:!0})}render(){const{schema:t,ui:e,source:s,pickSource:o}=this.state,n=o?"with-modal":"";return i.exports.createElement("div",{id:`app-${t.id}`,className:n},i.exports.createElement(he,{key:`viewport-${t.id}`,config:this.config,ui:e,schema:t}),i.exports.createElement(At,{key:`topbar-${t.id}`,config:this.config,ui:e,schema:t,source:s,onOpen:this.open.bind(this)}),i.exports.createElement(q,{key:`menu-${t.id}`,config:this.config,ui:e,schema:t}),o&&i.exports.createElement(Ee,{onPicked:a=>this.reload(a),onCanceled:()=>this.setState({pickSource:!1})}))}}var ve=document.getElementById("app");ht.exports.render(i.exports.createElement(be,null),ve);
